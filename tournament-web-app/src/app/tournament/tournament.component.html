<a routerLink="/"><button mat-icon-button><mat-icon>arrow_back</mat-icon></button></a>
<h1>Torneo:
    @if( tournamentId && tournament && isAdmin){
        <button mat-icon-button color="warn" (click)="onDelete()"><mat-icon>delete</mat-icon></button>
    }
</h1>    




<form [formGroup]="form">
   
    <mat-card>
        <mat-card-header>
            
            @if( tournamentId && tournament && isAdmin == false){
                <mat-card-title-group>
                    <mat-card-title>{{ tournament.label }}</mat-card-title>
                    @if( tournament ){
                        <mat-card-subtitle>
                        Fecha:{{tournament.eventDate.toDate() | date: 'dd/MM/yyyy'}}
                        Hora:{{tournament.eventTime}}
                        </mat-card-subtitle>                
                    }                    
                    <img mat-card-lg-image [src]="tournament.imageUrl" >
                </mat-card-title-group>    
            }
        </mat-card-header>  
          
        <mat-card-content>
            @if( !tournamentId || (isAdmin && tournament)){
                <div class="bar">
                    <div class="name-container">
                        <mat-form-field class="name-input">
                            <mat-label>Nombre del evento</mat-label>
                            <input matInput placeholder="" formControlName="label" (change)="onNameChange($event)">
                        </mat-form-field>
                        <div>
                            <mat-form-field color="accent" appearance="fill">
                                <mat-label>Fecha del evento</mat-label>
                                <input matInput [matDatepicker]="picker1" formControlName="eventDate"  (change)="onChange($event, tournamentId,'eventDate')">
                                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                <mat-datepicker #picker1></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field color="accent" appearance="fill">
                                <mat-label>Hora del evento</mat-label>            
                                <input matInput formControlName="eventTime" [format]="24" [ngxTimepicker]="picker" (change)="onChange($event,tournamentId,'eventTime')">
                                <ngx-material-timepicker #picker></ngx-material-timepicker> 
                            </mat-form-field> 
                        </div>                        
                    </div>    
                @if( tournament ){
                    @if( isAdmin ){
                        <app-image-loader [fullpath]="tournament.imagePath" [basepath]="getBasePath()" (onload)="fileLoaded($event)" (ondelete)="fileDeleted($event)"></app-image-loader>                    
                    }
                    @else{
                        <img mat-card-lg-image [src]="tournament.imageUrl" >
                    }
                }                  
                </div>
            }
            @if( tournamentId && tournament ){

                <mat-divider></mat-divider>
                <h2>Categorias   
                @if( isAdmin ){    
                    <a [routerLink]="['/','tournament',tournamentId,'categories']">
                        <button mat-button-icon><mat-icon>edit</mat-icon></button>
                    </a>
                }
                </h2>
                @for( category of tournament.categories; track category){
                    <h3>{{category.label}}</h3>
                    <quill-view-html [content]="category.description"></quill-view-html>                     
                }               

                @if(isAdmin){
                    <mat-divider></mat-divider>
                    <app-evaluation-list [tournamentId]="tournamentId" [tournament]="tournament"></app-evaluation-list>
    
                
                    <mat-divider></mat-divider>
                    <h2>Jurado
                    <a [routerLink]="['/','tournament',tournamentId,'jurors']">
                        <button mat-button-icon><mat-icon>edit</mat-icon></button>
                    </a>
                    </h2>  
                    @for( j of tournament.jurors; track j){
                        <span class="item">{{j.label}}</span>
                    }               
                }
    
                <mat-divider></mat-divider>        
                <h2>Premios
                @if(isAdmin){
                    <a [routerLink]="['/','tournament',tournamentId,'medals']">
                        <button mat-button-icon><mat-icon>edit</mat-icon></button>
                    </a>
                }
                </h2>  
                @for( medal of tournament.medals; track medal){
                    <h3>{{medal.label}}</h3>
                    <quill-view-html [content]="medal.description"></quill-view-html>                      
                } 
                <mat-divider></mat-divider> 
                <h2>Performances
                    @if( isLoggedIn ){
                        <button mat-button-icon (click)="onPerformancesEdit()"><mat-icon>edit</mat-icon></button>
                    }
                </h2> 
                @for( p of performances; track p){
                    <div class="item">
                    {{ p.performance.label }}
                    @if( p.isInProgram ){
                        <mat-icon>done</mat-icon>
                    }
                    </div>
                }
                @if( performances.length == 0){
                    <a [routerLink]="['/','tournament',tournamentId,'performances']">
                        <button mat-raised-button color="accent" >Quiero presentarme</button>
                    </a>
                }   

                <mat-divider></mat-divider>                              
                <h2>Programa
                @if( isAdmin ){    
                    <a [routerLink]="['/','tournament',tournamentId,'program']">
                    <button mat-button-icon><mat-icon>edit</mat-icon></button>
                </a>
                }</h2> 
                @for( p of program; track p){
                    <div class="item">{{ p.performance.label }}</div>
                }
                @empty{
                    <h3>No se han adicionado performances al programa</h3>
                }                  
                <mat-divider></mat-divider>                  
                <h2>Podium<a [routerLink]="['/','tournament',tournamentId,'podium']">
                    <button mat-button-icon><mat-icon>emoji_events</mat-icon></button>
                </a></h2>                                                             
            }  


        </mat-card-content>   
        <mat-card-actions>
            @if( !tournamentId ){
                <button mat-button-icon (click)="onSubmit()" [disabled]="!form.valid"><mat-icon>done</mat-icon></button>
            }
        </mat-card-actions>
           
    </mat-card>    
</form>
